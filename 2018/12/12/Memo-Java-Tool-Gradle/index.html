<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>Gradle | Kuangcp Blog | Javaer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Gradle">
    <meta name="description" content="目录 start  Gradle 书籍 发行版本列表 安装配置 SDKMAN方式 Chocolate 命令行选项 守护进程 Docker安装   配置镜像源   关键配置文件 build.gradle 初始化一个新项目 依赖定义 统一依赖管理 配置Wrapper 插件 常用插件     setting.gradle Gradle多模块的构建 另一种方式       部署 War包 Jar包 上传至">
<meta name="keywords" content="Gradle">
<meta property="og:type" content="article">
<meta property="og:title" content="Gradle">
<meta property="og:url" content="http://blog.kuangcp.top/2018/12/12/Memo-Java-Tool-Gradle/index.html">
<meta property="og:site_name" content="Kuangcp Blog">
<meta property="og:description" content="目录 start  Gradle 书籍 发行版本列表 安装配置 SDKMAN方式 Chocolate 命令行选项 守护进程 Docker安装   配置镜像源   关键配置文件 build.gradle 初始化一个新项目 依赖定义 统一依赖管理 配置Wrapper 插件 常用插件     setting.gradle Gradle多模块的构建 另一种方式       部署 War包 Jar包 上传至">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2018-12-21T03:02:53.346Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Gradle">
<meta name="twitter:description" content="目录 start  Gradle 书籍 发行版本列表 安装配置 SDKMAN方式 Chocolate 命令行选项 守护进程 Docker安装   配置镜像源   关键配置文件 build.gradle 初始化一个新项目 依赖定义 统一依赖管理 配置Wrapper 插件 常用插件     setting.gradle Gradle多模块的构建 另一种方式       部署 War包 Jar包 上传至">
    
        <link rel="alternate" type="application/atom+xml" title="Kuangcp Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Kuangcp</h5>
          <a href="mailto:kuangcp@aliyun.com" title="kuangcp@aliyun.com" class="mail">kuangcp@aliyun.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/">
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives">
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags">
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories">
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/kuangcp" target="_blank">
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Gradle</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Gradle</h1>
        <h5 class="subtitle">
            
                <time datetime="2018-12-12T13:29:59.000Z" itemprop="datePublished" class="page-time">
  2018-12-12
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Java/">Java</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Gradle"><span class="post-toc-number">1.</span> <span class="post-toc-text">Gradle</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#书籍"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">书籍</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#发行版本列表"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">发行版本列表</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#安装配置"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">安装配置</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#SDKMAN方式"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">SDKMAN方式</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Chocolate"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">Chocolate</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#命令行选项"><span class="post-toc-number">1.3.3.</span> <span class="post-toc-text">命令行选项</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#守护进程"><span class="post-toc-number">1.3.4.</span> <span class="post-toc-text">守护进程</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Docker安装"><span class="post-toc-number">1.3.5.</span> <span class="post-toc-text">Docker安装</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#配置镜像源"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">配置镜像源</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#关键配置文件"><span class="post-toc-number">2.</span> <span class="post-toc-text">关键配置文件</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#build-gradle"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">build.gradle</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#初始化一个新项目"><span class="post-toc-number">2.1.1.</span> <span class="post-toc-text">初始化一个新项目</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#依赖定义"><span class="post-toc-number">2.1.2.</span> <span class="post-toc-text">依赖定义</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#统一依赖管理"><span class="post-toc-number">2.1.3.</span> <span class="post-toc-text">统一依赖管理</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#配置Wrapper"><span class="post-toc-number">2.1.4.</span> <span class="post-toc-text">配置Wrapper</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#插件"><span class="post-toc-number">2.1.5.</span> <span class="post-toc-text">插件</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#常用插件"><span class="post-toc-number">2.1.5.1.</span> <span class="post-toc-text">常用插件</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#setting-gradle"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">setting.gradle</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Gradle多模块的构建"><span class="post-toc-number">2.2.1.</span> <span class="post-toc-text">Gradle多模块的构建</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#另一种方式"><span class="post-toc-number">2.2.1.1.</span> <span class="post-toc-text">另一种方式</span></a></li></ol></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#部署"><span class="post-toc-number">3.</span> <span class="post-toc-text">部署</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#War包"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">War包</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Jar包"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">Jar包</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#上传至构建仓库"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">上传至构建仓库</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#构建Docker镜像"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">构建Docker镜像</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#第二种插件方式"><span class="post-toc-number">3.4.1.</span> <span class="post-toc-text">第二种插件方式</span></a></li></ol></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-Memo-Java-Tool-Gradle" class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Gradle</h1>
        <div class="post-meta">
            <time class="post-time" title="2018-12-12 21:29:59" datetime="2018-12-12T13:29:59.000Z" itemprop="datePublished">2018-12-12</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Java/">Java</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style="display:none">
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p><strong>目录 start</strong></p>
<ol>
<li><a href="#gradle">Gradle</a><ol>
<li><a href="#书籍">书籍</a></li>
<li><a href="#发行版本列表">发行版本列表</a></li>
<li><a href="#安装配置">安装配置</a><ol>
<li><a href="#sdkman方式">SDKMAN方式</a></li>
<li><a href="#chocolate">Chocolate</a></li>
<li><a href="#命令行选项">命令行选项</a></li>
<li><a href="#守护进程">守护进程</a></li>
<li><a href="#docker安装">Docker安装</a></li>
</ol>
</li>
<li><a href="#配置镜像源">配置镜像源</a></li>
</ol>
</li>
<li><a href="#关键配置文件">关键配置文件</a><ol>
<li><a href="#buildgradle">build.gradle</a><ol>
<li><a href="#初始化一个新项目">初始化一个新项目</a></li>
<li><a href="#依赖定义">依赖定义</a></li>
<li><a href="#统一依赖管理">统一依赖管理</a></li>
<li><a href="#配置wrapper">配置Wrapper</a></li>
<li><a href="#插件">插件</a><ol>
<li><a href="#常用插件">常用插件</a></li>
</ol>
</li>
</ol>
</li>
<li><a href="#settinggradle">setting.gradle</a><ol>
<li><a href="#gradle多模块的构建">Gradle多模块的构建</a><ol>
<li><a href="#另一种方式">另一种方式</a></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li><a href="#部署">部署</a><ol>
<li><a href="#war包">War包</a></li>
<li><a href="#jar包">Jar包</a></li>
<li><a href="#上传至构建仓库">上传至构建仓库</a></li>
<li><a href="#构建docker镜像">构建Docker镜像</a><ol>
<li><a href="#第二种插件方式">第二种插件方式</a></li>
</ol>
</li>
</ol>
</li>
</ol>
<p><strong>目录 end</strong>|<em>2018-12-13 12:06</em>| <a href="https://gitee.com/gin9" target="_blank" rel="noopener">码云</a> | <a href="http://blog.csdn.net/kcp606" target="_blank" rel="noopener">CSDN</a> | <a href="https://my.oschina.net/kcp1104" target="_blank" rel="noopener">OSChina</a> | <a href="http://www.cnblogs.com/kuangcp" target="_blank" rel="noopener">cnblogs</a></p>
<hr>
<h1 id="Gradle"><a href="#Gradle" class="headerlink" title="Gradle"></a>Gradle</h1><blockquote>
<p><a href="https://gradle.org/guides/?q=JVM" target="_blank" rel="noopener">官方 guide</a> | <a href="https://www.tutorialspoint.com/gradle/index.htm" target="_blank" rel="noopener">其他 tutorial</a><br><a href="https://www.jianshu.com/p/47cbbb4eab13" target="_blank" rel="noopener">参考博客: 零散知识点总结(1) - Gradle 使用配置总结</a></p>
</blockquote>
<p><strong>个人看法</strong></p>
<blockquote>
<p><a href="www.infoq.com/cn/articles/Gradle-application-in-large-Java-projects">参考: Gradle在大型Java项目上的应用</a></p>
</blockquote>
<p><strong>优缺点</strong></p>
<blockquote>
<p><a href="https://blog.csdn.net/MCL529/article/details/79341706" target="_blank" rel="noopener">Gradle大吐槽</a><br><a href="https://gradle.org/maven-vs-gradle/" target="_blank" rel="noopener">官方对比Gradle和Maven</a></p>
</blockquote>
<blockquote>
<p>优点  </p>
<ol>
<li>相对于Maven, 配置文件简洁了很多, 所以才入坑学习使用的</li>
<li>对于一些需要自定义的任务,因为核心为Groovy,所以实现能力高<ul>
<li>例如:将一个SpringBoot项目构建成一个镜像,并tag上当前构建的镜像为release,然后删除旧有容器,使用新的镜像启动容器</li>
</ul>
</li>
</ol>
</blockquote>
<blockquote>
<p>缺点  </p>
<ol>
<li>内存占用巨大,存在内存泄露问题, 以至于在IDEA上不敢使用自动导入, 不然每动一下build.gradle 就会卡半天, 8G内存都不够用!!</li>
<li>编译速度慢, 如果和Maven进行对比, 编译速度和资源占用确实慢</li>
</ol>
</blockquote>
<hr>
<h2 id="书籍"><a href="#书籍" class="headerlink" title="书籍"></a>书籍</h2><blockquote>
<p><a href="http://www.jb51.net/books/527811.html" target="_blank" rel="noopener">Gradle in Action 中译</a> <code>如果没有一点Groovy基础, 阅读自定义Task等一些高自定义的地方还是比较困惑</code></p>
</blockquote>
<h2 id="发行版本列表"><a href="#发行版本列表" class="headerlink" title="发行版本列表"></a>发行版本列表</h2><blockquote>
<p><a href="http://services.gradle.org/" target="_blank" rel="noopener">官方网址</a> 有各个版本的下载以及版本发行说明<br><a href="https://github.com/gradle/gradle/releases" target="_blank" rel="noopener">Github地址</a><code>查看简洁的 Release Note 更方便</code></p>
</blockquote>
<h2 id="安装配置"><a href="#安装配置" class="headerlink" title="安装配置"></a>安装配置</h2><blockquote>
<p>和maven使用同一个本地库 只要加上 M2_HOME 环境变量即可, 值和 MAVEN_HOME 一样, 并没有用</p>
</blockquote>
<h3 id="SDKMAN方式"><a href="#SDKMAN方式" class="headerlink" title="SDKMAN方式"></a>SDKMAN方式</h3><ul>
<li>先安装sdkman</li>
<li>使用Bash运行<code>curl -s &quot;https://get.sdkman.io&quot; | bash</code></li>
<li><code>sdk install gradle</code> 即可安装</li>
</ul>
<h3 id="Chocolate"><a href="#Chocolate" class="headerlink" title="Chocolate"></a>Chocolate</h3><ul>
<li>windows 上安装 chocolate</li>
<li>PowerShell中运行 <code>wr https://chocolatey.org/install.ps1 -UseBasicParsing | iex</code></li>
<li>若操作系统默认禁止执行脚本，执行一次<code>set-executionpolicy remotesigned</code>后脚本顺利执行</li>
<li>Chocolatey在安装包的时候，默认路径是按照系统的默认路径来的，如果想修改安装路径可以这样处理：</li>
</ul>
<ol>
<li>执行“开始/运行”命令（或者WIN + R），输入“regedit”，打开注册表。</li>
<li>展开注册表到下面的分支[HKEY＿LOCAL＿MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion]，在右侧窗口中找到名为“ProgramFilesDir”的字符串，双击把数值“C:\Program Files”修改为“D：\ProgramFiles”，确定退出后,即可更改常用软件的安装路径了。</li>
</ol>
<h3 id="命令行选项"><a href="#命令行选项" class="headerlink" title="命令行选项"></a>命令行选项</h3><ul>
<li><code>gradle 构建文件中的task名</code>： 直接运行task</li>
<li><code>-b，--build-file test.gradle</code> 指定运行脚本文件</li>
<li><code>--offline</code> 离线模式</li>
<li><code>-P ,--project-prop</code>:配置参数 -Pmyprop=value</li>
<li><code>-i,--info</code> : 打印info级别的输出</li>
<li><code>-s,--stacktrace</code>: 输出错误栈</li>
<li><code>-q,--quiet</code>:减少构建出错时打印的错误信息</li>
<li><code>tasks</code> : 输出所有建立的task</li>
<li><code>properties</code> : 输出所有可用的配置属性</li>
</ul>
<h3 id="守护进程"><a href="#守护进程" class="headerlink" title="守护进程"></a>守护进程</h3><ul>
<li>命令加上 <code>--daemon</code>就会开启一个守护进程，只会开启一次，</li>
<li>守护进程会在空闲3小时后销毁</li>
<li>手动关闭 <code>gadle --stop</code></li>
<li>构建时不采用守护进程 <code>--no--daemon</code></li>
</ul>
<h3 id="Docker安装"><a href="#Docker安装" class="headerlink" title="Docker安装"></a>Docker安装</h3><blockquote>
<p><a href="https://docs.docker.com/samples/library/gradle/" target="_blank" rel="noopener">Docker 文档</a></p>
</blockquote>
<hr>
<h2 id="配置镜像源"><a href="#配置镜像源" class="headerlink" title="配置镜像源"></a>配置镜像源</h2><p><strong>阿里云</strong></p>
<blockquote>
<p><a href="https://tvzr.com/change-the-mirror-of-gradle-to-aliyun.html" target="_blank" rel="noopener">参考博客: 配置Gradle的镜像为阿里云镜像</a></p>
</blockquote>
<p><em>当前项目的build.gradle</em><br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">repositories &#123;</span><br><span class="line">  <span class="keyword">def</span> aliyun = <span class="string">"http://maven.aliyun.com/nexus/content/groups/public/"</span></span><br><span class="line">  <span class="keyword">def</span> abroad = <span class="string">"http://central.maven.org/maven2/"</span></span><br><span class="line">  maven &#123;</span><br><span class="line">    url = aliyun</span><br><span class="line">    artifactUrls abroad</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 马云上自己的库</span></span><br><span class="line">  maven &#123;</span><br><span class="line">    url = <span class="string">"https://gitee.com/gin9/MavenRepos/raw/master"</span></span><br><span class="line">  &#125;</span><br><span class="line">  mavenCentral()</span><br><span class="line">  jcenter()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>全局的配置</strong><br><em>~/.gradle/init.gradle</em><br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">allprojects&#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        <span class="keyword">def</span> ALIYUN_REPOSITORY_URL = <span class="string">'http://maven.aliyun.com/nexus/content/groups/public'</span></span><br><span class="line">        <span class="keyword">def</span> ALIYUN_JCENTER_URL = <span class="string">'http://maven.aliyun.com/nexus/content/repositories/jcenter'</span></span><br><span class="line">        all &#123; ArtifactRepository repo -&gt;</span><br><span class="line">            <span class="keyword">if</span>(repo <span class="keyword">instanceof</span> MavenArtifactRepository)&#123;</span><br><span class="line">                <span class="keyword">def</span> url = repo.url.toString()</span><br><span class="line">                <span class="keyword">if</span> (url.startsWith(<span class="string">'https://repo1.maven.org/maven2'</span>)) &#123;</span><br><span class="line">                    project.logger.lifecycle <span class="string">"Repository $&#123;repo.url&#125; replaced by $ALIYUN_REPOSITORY_URL."</span></span><br><span class="line">                    remove repo</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (url.startsWith(<span class="string">'https://jcenter.bintray.com/'</span>)) &#123;</span><br><span class="line">                    project.logger.lifecycle <span class="string">"Repository $&#123;repo.url&#125; replaced by $ALIYUN_JCENTER_URL."</span></span><br><span class="line">                    remove repo</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        maven &#123;</span><br><span class="line">        	url ALIYUN_REPOSITORY_URL</span><br><span class="line">            url ALIYUN_JCENTER_URL</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h1 id="关键配置文件"><a href="#关键配置文件" class="headerlink" title="关键配置文件"></a>关键配置文件</h1><h2 id="build-gradle"><a href="#build-gradle" class="headerlink" title="build.gradle"></a>build.gradle</h2><p><em>Hello World</em><br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">task helloworld&#123;</span><br><span class="line">   doLast &#123;</span><br><span class="line">      printf <span class="string">'Hello World!'</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 或者是 使用 &lt;&lt; 代表doLast：</span></span><br><span class="line">task helloworld&lt;&lt;&#123;</span><br><span class="line">   println <span class="string">'Hello world!'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>运行：<code>gradle -q helloworld</code></li>
</ul>
<h3 id="初始化一个新项目"><a href="#初始化一个新项目" class="headerlink" title="初始化一个新项目"></a>初始化一个新项目</h3><blockquote>
<p><a href="https://guides.gradle.org/building-java-applications/" target="_blank" rel="noopener">doc:building java application</a></p>
</blockquote>
<h3 id="依赖定义"><a href="#依赖定义" class="headerlink" title="依赖定义"></a>依赖定义</h3><ul>
<li>和Maven用的是同一种方式 groupId artifactId version </li>
<li>使用本地依赖 <code>compile files(&#39;lib/ojdbc-14.jar&#39;)</code> 相对的根目录是src同级目录</li>
</ul>
<blockquote>
<p><a href="https://docs.gradle.org/current/userguide/java_plugin.html#sec:java_plugin_and_dependency_management" target="_blank" rel="noopener">Official doc: dependency management</a><br>4.10  Deprecated: <code>compile runtime testCompile testRuntime</code></p>
</blockquote>
<ul>
<li><p><code>compile(Deprecated)</code></p>
<ul>
<li>Compile time dependencies. Superseded by implementation.</li>
</ul>
</li>
<li><p><code>implementation extends compile</code></p>
<ul>
<li>Implementation only dependencies.</li>
</ul>
</li>
<li><p><code>compileOnly</code></p>
<ul>
<li>Compile time only dependencies, not used at runtime.</li>
</ul>
</li>
<li><p><code>compileClasspath extends compile, compileOnly, implementation</code></p>
<ul>
<li>Compile classpath, used when compiling source. Used by task compileJava.</li>
</ul>
</li>
<li><p><code>annotationProcessor</code></p>
<ul>
<li>Annotation processors used during compilation.</li>
</ul>
</li>
<li><p><code>runtime(Deprecated) extends compile</code></p>
<ul>
<li>Runtime dependencies. Superseded by runtimeOnly.</li>
</ul>
</li>
<li><p><code>runtimeOnly</code></p>
<ul>
<li>Runtime only dependencies.</li>
</ul>
</li>
<li><p><code>runtimeClasspath extends runtimeOnly, runtime, implementation</code></p>
<ul>
<li>Runtime classpath contains elements of the implementation, as well as runtime only elements.</li>
</ul>
</li>
<li><p><code>testCompile(Deprecated) extends compile</code></p>
<ul>
<li>Additional dependencies for compiling tests. Superseded by testImplementation.</li>
</ul>
</li>
<li><p><code>testImplementation extends testCompile, implementation</code></p>
<ul>
<li>Implementation only dependencies for tests.</li>
</ul>
</li>
<li><p><code>testCompileOnly</code></p>
<ul>
<li>Additional dependencies only for compiling tests, not used at runtime.</li>
</ul>
</li>
<li><p><code>testCompileClasspath extends testCompile, testCompileOnly, testImplementation</code></p>
<ul>
<li>Test compile classpath, used when compiling test sources. Used by task compileTestJava.</li>
</ul>
</li>
<li><p><code>testRuntime(Deprecated) extends runtime, testCompile</code></p>
<ul>
<li>Additional dependencies for running tests only. Used by task test. Superseded by testRuntimeOnly.</li>
</ul>
</li>
<li><p><code>testRuntimeOnly extends runtimeOnly</code></p>
<ul>
<li>Runtime only dependencies for running tests. Used by task test.</li>
</ul>
</li>
<li><p><code>testRuntimeClasspath extends testRuntimeOnly, testRuntime, testImplementation</code></p>
<ul>
<li>Runtime classpath for running tests.</li>
</ul>
</li>
<li><p><code>archives</code></p>
<ul>
<li>Artifacts (e.g. jars) produced by this project. Used by tasks uploadArchives.</li>
</ul>
</li>
<li><p><code>default extends runtime</code></p>
<ul>
<li>The default configuration used by a project dependency on this project. Contains the artifacts - and dependencies required by this project at runtime.</li>
</ul>
</li>
</ul>
<blockquote>
<p>依赖排除以及指定依赖版本<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 依赖排除</span></span><br><span class="line">compile(<span class="string">''</span>)&#123;</span><br><span class="line">    exclude <span class="string">group:</span> <span class="string">''</span> <span class="comment">// 按group排除</span></span><br><span class="line">    exclude <span class="string">module:</span> <span class="string">''</span> <span class="comment">// 按 artifact 排除</span></span><br><span class="line">    exclude <span class="string">grop:</span> <span class="string">''</span>, <span class="string">module:</span> <span class="string">''</span> <span class="comment">// 按 group artifact 排除</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 全局依赖排除</span></span><br><span class="line">all*.exclude <span class="string">group:</span><span class="string">'org.unwanted'</span>, <span class="string">module:</span> <span class="string">'iAmBuggy'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 禁用依赖传递</span></span><br><span class="line">compile(<span class="string">'com.zhyea:ar4j:1.0'</span>) &#123;</span><br><span class="line"> transitive = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">configurations.all &#123;</span><br><span class="line">    transitive = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 强制使用指定版本的依赖</span></span><br><span class="line">compile(<span class="string">'com.zhyea:ar4j:1.0'</span>) &#123;</span><br><span class="line">    force = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 始终使用最新的依赖,  若 1.+ 则是 1.xx版本的最新版</span></span><br><span class="line">compile <span class="string">'com.zhyea:ar4j:+'</span></span><br><span class="line"></span><br><span class="line">configurations.all &#123;</span><br><span class="line">    resolutionStrategy &#123;</span><br><span class="line">        force <span class="string">'org.hamcrest:hamcrest-core:1.3'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="统一依赖管理"><a href="#统一依赖管理" class="headerlink" title="统一依赖管理"></a>统一依赖管理</h3><p>新建一个文件 <em>dependency.gradle</em><br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ext &#123;</span><br><span class="line">    ver = [</span><br><span class="line">        <span class="string">junit     :</span> <span class="string">'4.12'</span>,</span><br><span class="line">    ]</span><br><span class="line">    libs = [</span><br><span class="line">        <span class="string">"junit"</span>   : <span class="string">"junit:junit:$ver.junit"</span>,</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>在 build.gradle 中引入 <code>apply from: &#39;dependency.gradle&#39;</code></li>
<li>使用依赖时 只需 <code>compile libs[&#39;junit&#39;]</code> 即使在子模块中也是如此使用</li>
</ul>
<h3 id="配置Wrapper"><a href="#配置Wrapper" class="headerlink" title="配置Wrapper"></a>配置Wrapper</h3><blockquote>
<p>在使用IDE生成项目的时候，可以选择gradle的执行目录，可以选<code>gradle wrapper</code> 也可以选自己下载解压的完整包<br>如果使用的不是这个wrapper，那么别人在下载项目后，运行gradle命令就要先安装gradle，使用wrapper更好<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">task wrapper(<span class="string">type:</span> Wrapper)&#123;</span><br><span class="line">   gradleVersion = <span class="string">'4.8'</span></span><br><span class="line">   distributionUrl = <span class="string">'限定访问内网的URL'</span></span><br><span class="line">   distributionPath = <span class="string">'包装器被解压缩放的相对路径'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<ul>
<li>运行 gradle wrapper 一次即可开始使用包装器的脚本来构建项目了</li>
<li>生成gradle包管理器：<code>gradle wrapper --gradle-version 2.0</code></li>
</ul>
<h3 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h3><p>有多种方式:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1</span></span><br><span class="line">apply <span class="string">plugin:</span> <span class="string">'java'</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line">apply&#123;</span><br><span class="line">    <span class="string">'java'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line">plugins&#123;</span><br><span class="line">    id <span class="string">'java'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="常用插件"><a href="#常用插件" class="headerlink" title="常用插件"></a>常用插件</h4><ul>
<li>lombok<blockquote>
<p><a href="https://stackoverflow.com/questions/50519138/annotationprocessor-gradle-4-7-configuration-doesnt-run-lombok" target="_blank" rel="noopener">使用Lombok的正确方式</a> | <a href="https://projectlombok.org/setup/gradle" target="_blank" rel="noopener">gradle lombok plugin</a></p>
</blockquote>
</li>
</ul>
<p><a href="https://docs.gradle.org/4.7-rc-1/userguide/java_plugin.html#sec:java_compile_avoidance" target="_blank" rel="noopener">官方文档</a><br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">annotationProcessor <span class="string">'org.projectlombok:lombok:1.18.2'</span></span><br><span class="line">compileOnly <span class="string">'org.projectlombok:lombok:1.18.2'</span></span><br><span class="line">testAnnotationProcessor <span class="string">'org.projectlombok:lombok:1.18.2'</span></span><br><span class="line">testCompileOnly <span class="string">'org.projectlombok:lombok:1.18.2'</span></span><br></pre></td></tr></table></figure></p>
<hr>
<ul>
<li><p>maven </p>
<ul>
<li><code>apply plugin: &quot;maven&quot;</code> 然后就能执行 install等命令了</li>
<li>gradle 4.8 用不了 <a href="https://blog.csdn.net/mxw2552261/article/details/78640338" target="_blank" rel="noopener">需要这种方式</a></li>
</ul>
</li>
<li><p>shadowJar 含依赖的jar进行打包</p>
</li>
<li><p>docker 提供Docker操作</p>
<ul>
<li><code>apply plugin: &#39;docker&#39;</code></li>
<li>buildscript dependencies 中添加<code>classpath(&#39;se.transmode.gradle:gradle-docker:1.2&#39;)</code></li>
</ul>
</li>
</ul>
<hr>
<h2 id="setting-gradle"><a href="#setting-gradle" class="headerlink" title="setting.gradle"></a>setting.gradle</h2><blockquote>
<p>项目的配置信息, 一般存在这个文件的时候, Gradle就会认为当前目录是作为一个完整的根项目的, 并在当前目录添加 .gradle 目录<br>一般默认内容为 <code>rootProject.name = &#39;&#39;</code></p>
</blockquote>
<h3 id="Gradle多模块的构建"><a href="#Gradle多模块的构建" class="headerlink" title="Gradle多模块的构建"></a>Gradle多模块的构建</h3><blockquote>
<p><a href="https://guides.gradle.org/creating-multi-project-builds/" target="_blank" rel="noopener">官网文档 creating multi project builds </a></p>
</blockquote>
<blockquote>
<p>采用一个文件统一管理依赖, 然后各个子项目独立引用 | <a href="https://github.com/Kuangcp/JavaBase" target="_blank" rel="noopener">完整示例 JavaBase</a><code>统一配置依赖, 管理多模块</code> </p>
</blockquote>
<p><em>如果要添加一个项目也简单</em></p>
<ol>
<li>直接新建一个目录 test</li>
<li>目录下新建空的文件 build.gradle</li>
<li>在根项目的 setting.gradle 中的include 加入 test (可以和文件夹不同名, build.gradle配置下就行了, 建议同名)</li>
<li>gradle build 整个项目, 就完成了</li>
<li>最后就是手动的新建项目结构</li>
</ol>
<hr>
<h4 id="另一种方式"><a href="#另一种方式" class="headerlink" title="另一种方式"></a>另一种方式</h4><blockquote>
<p><a href="https://www.jianshu.com/p/ac4c00a63750" target="_blank" rel="noopener">参考博客:重拾后端之Spring Boot（六） – 热加载、容器和多项目</a><br>直接在build.gradle中配置 </p>
</blockquote>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一个典型的根项目的构建文件结构</span></span><br><span class="line">buildscript &#123;</span><br><span class="line">    <span class="comment">//  构建脚本段落可以配置整个项目需要的插件，构建过程中的依赖以及依赖类库的版本号等</span></span><br><span class="line">&#125;</span><br><span class="line">allprojects &#123;</span><br><span class="line">    <span class="comment">//  在这个段落中你可以声明对于所有项目（含根项目）都适用的配置，比如依赖性的仓储等</span></span><br><span class="line">&#125;</span><br><span class="line">subprojects &#123;</span><br><span class="line">    <span class="comment">//  * 在这个段落中你可以声明适用于各子项目的配置（不包括根项目哦）</span></span><br><span class="line">    version = <span class="string">"0.0.1"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//  * 对于子项目的特殊配置</span></span><br><span class="line">project(<span class="string">':common'</span>) &#123;</span><br><span class="line">&#125;</span><br><span class="line">project(<span class="string">':api'</span>) &#123;</span><br><span class="line">&#125;</span><br><span class="line">project(<span class="string">':report'</span>) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">project(<span class="string">':common'</span>) &#123;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        compile(<span class="string">"org.springframework.boot:spring-boot-starter-data-rest"</span>)</span><br><span class="line">        compile(<span class="string">"org.springframework.boot:spring-boot-starter-data-mongodb"</span>)</span><br><span class="line">        compile(<span class="string">"org.projectlombok:lombok:$&#123;lombokVersion&#125;"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">project(<span class="string">':api'</span>) &#123;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        compile project(<span class="string">':common'</span>)</span><br><span class="line">        compile(<span class="string">"org.springframework.boot:spring-boot-devtools"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">project(<span class="string">':report'</span>) &#123;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        compile project(<span class="string">':common'</span>)</span><br><span class="line">        compile(<span class="string">"org.springframework.boot:spring-boot-devtools"</span>)</span><br><span class="line">        compile files([<span class="string">"lib/simsun.jar"</span>])</span><br><span class="line">        compile(<span class="string">"org.springframework.boot:spring-boot-starter-web"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://github.com/Kuangcp/GradleIntegrationMultipleModules" target="_blank" rel="noopener">有关多模块的构建详情参考这里</a></li>
<li><a href="https://github.com/someok/gradle-multi-project-example" target="_blank" rel="noopener">参考更为规范的多项目构建</a></li>
</ul>
<hr>
<h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><h2 id="War包"><a href="#War包" class="headerlink" title="War包"></a>War包</h2><h2 id="Jar包"><a href="#Jar包" class="headerlink" title="Jar包"></a>Jar包</h2><ul>
<li>Gradle默认是只会打包源码，并不会打包依赖（为了更方便依赖的作用）<ul>
<li><a href="http://imperceptiblethoughts.com/shadow/" target="_blank" rel="noopener">shadow插件官网文档</a></li>
</ul>
</li>
<li>添加 <code>apply plugin: &quot;maven&quot;</code> 然后就能和mvn install 一样的执行 gradle install 了</li>
</ul>
<h2 id="上传至构建仓库"><a href="#上传至构建仓库" class="headerlink" title="上传至构建仓库"></a>上传至构建仓库</h2><blockquote>
<p>特别注意使用gpg, 如果按这下面的一堆文档跟着做的话你要保证你的gpg小于等于2.0版本, 不然就卡在这里了</p>
</blockquote>
<blockquote>
<p><a href="https://github.com/haiyangwu/sonatype" target="_blank" rel="noopener">参考项目 </a><br><a href="https://www.jianshu.com/p/49c926589f41" target="_blank" rel="noopener">参考</a><br><a href="http://central.sonatype.org/pages/gradle.html" target="_blank" rel="noopener">官方文档</a><br><a href="http://blog.csdn.net/h3243212/article/details/72374363#%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98" target="_blank" rel="noopener">参考博客</a><br><a href="https://blog.csdn.net/kcp606/article/details/79675590" target="_blank" rel="noopener">最简单的方式就是利用码云等平台创建私服 </a></p>
</blockquote>
<h2 id="构建Docker镜像"><a href="#构建Docker镜像" class="headerlink" title="构建Docker镜像"></a>构建Docker镜像</h2><blockquote>
<p><a href="http://www.importnew.com/24671.html" target="_blank" rel="noopener">用 Docker、Gradle 来构建、运行、发布一个 Spring Boot 应用</a></p>
</blockquote>
<p><em>build.gradle</em><br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">plugin:</span> <span class="string">'docker'</span></span><br><span class="line">buildscript &#123;</span><br><span class="line">    ext &#123;</span><br><span class="line">        springBootVersion = <span class="string">'2.0.1.RELEASE'</span></span><br><span class="line">    &#125;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath(<span class="string">"org.springframework.boot:spring-boot-gradle-plugin:$&#123;springBootVersion&#125;"</span>)</span><br><span class="line">        classpath(<span class="string">'se.transmode.gradle:gradle-docker:1.2'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">task buildDocker(<span class="string">type:</span> Docker, <span class="string">dependsOn:</span> build) &#123;</span><br><span class="line">    <span class="comment">//设置自动上传的话，命名就不能乱取了，仓库名/镜像名：tag</span></span><br><span class="line"><span class="comment">//    push = true</span></span><br><span class="line">    test.enabled=<span class="literal">false</span></span><br><span class="line">    applicationName = jar.baseName</span><br><span class="line">    dockerfile = file(<span class="string">'src/main/docker/Dockerfile'</span>)</span><br><span class="line">    doFirst &#123;</span><br><span class="line">        copy &#123;</span><br><span class="line">            from war</span><br><span class="line">            into stageDir</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>Dockerfile</em><br><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> frolvlad/alpine-oraclejdk8:slim</span><br><span class="line"><span class="keyword">VOLUME</span><span class="bash"> /tmp</span></span><br><span class="line"><span class="bash"><span class="comment"># 配置通配符是为了不受版本影响</span></span></span><br><span class="line"><span class="bash">ADD weixin*.war app.war</span></span><br><span class="line"><span class="bash"><span class="comment"># ENTRYPOINT ["java","-Djava.security.egd=file:/dev/./urandom","-jar","/app.war"]</span></span></span><br><span class="line"><span class="bash">ENTRYPOINT [<span class="string">"java"</span>,<span class="string">"-jar"</span>,<span class="string">"/app.war"</span>]</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li><code>gradle buildDocker</code> 即可构建镜像</li>
<li>运行 <code>docker run --name web --link postgre:db -p 5678:8889 -it 镜像</code> 注意其中要关联PostgreSQL的容器</li>
</ul>
<h3 id="第二种插件方式"><a href="#第二种插件方式" class="headerlink" title="第二种插件方式"></a>第二种插件方式</h3><blockquote>
<p><a href="https://www.jianshu.com/p/7571fa3b394c" target="_blank" rel="noopener">参考  通过Gradle使用Docker部署 Spring Boot项目</a></p>
</blockquote>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2018-12-21T03:02:53.346Z" itemprop="dateUpdated">2018-12-21 11:02:53</time>
</span><br>


        
        当前：<a href="/2018/12/12/Memo-Java-Tool-Gradle/" target="_blank" rel="external">http://blog.kuangcp.top/2018/12/12/Memo-Java-Tool-Gradle/</a>
        
    </div>
    
    <footer>
        <a href="http://blog.kuangcp.top">
            <img src="/img/avatar.jpg" alt="Kuangcp">
            Kuangcp
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Gradle/">Gradle</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.kuangcp.top/2018/12/12/Memo-Java-Tool-Gradle/&title=《Gradle》 — Kuangcp Blog&pic=http://blog.kuangcp.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.kuangcp.top/2018/12/12/Memo-Java-Tool-Gradle/&title=《Gradle》 — Kuangcp Blog&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.kuangcp.top/2018/12/12/Memo-Java-Tool-Gradle/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Gradle》 — Kuangcp Blog&url=http://blog.kuangcp.top/2018/12/12/Memo-Java-Tool-Gradle/&via=http://blog.kuangcp.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://blog.kuangcp.top/2018/12/12/Memo-Java-Tool-Gradle/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2018/12/13/Memo-Python-PythonConcurrent/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">PythonConcurrent.md</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2018/12/11/Memo-Java-Tool-GradleAdvance/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Gradle进阶</h4>
      </a>
    </div>
  
</nav>



    

















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.png" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/wechat.png" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style="display:none">
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style="display:none">
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>Kuangcp &copy; 2015 - 2018</span>
            <span>
                
                <a href="http://www.miitbeian.gov.cn/" target="_blank">赣ICP备17014189号-1</a><br>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.kuangcp.top/2018/12/12/Memo-Java-Tool-Gradle/&title=《Gradle》 — Kuangcp Blog&pic=http://blog.kuangcp.top/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.kuangcp.top/2018/12/12/Memo-Java-Tool-Gradle/&title=《Gradle》 — Kuangcp Blog&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.kuangcp.top/2018/12/12/Memo-Java-Tool-Gradle/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Gradle》 — Kuangcp Blog&url=http://blog.kuangcp.top/2018/12/12/Memo-Java-Tool-Gradle/&via=http://blog.kuangcp.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://blog.kuangcp.top/2018/12/12/Memo-Java-Tool-Gradle/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACM0lEQVR42u3azW6EMAxFYd7/pZltpQ7puTZUwjlZjQolfCws/+Q48Dp/rN9/IVevnrne5eYlQ4aM1zLO5eIbXN1DnsM/x+WbyJAhYwPGOiCu77nangff2r4yZMiQsX4tEhBrGBkyZMi4i7FOAfsFswwZMmTUiti0EOUB919rcRkyZLyQ0QmCT/9+ZL4hQ4aMVzHOcKUttvX4kwwP0FvJkCFjNIMHuLRZRoagnYArQ4aMfRjpC5HQSQpafhQDlawyZMjYgMFb/OkwgDfLWsMJGTJkjGaso1anxc/DJS9u40GmDBkyRjA6DTLyCWrBmqSSl0WsDBkyxjFqyVmnKO0UsWi0KUOGjHGMTpHJG3DkajrC/JIaypAhYxsG3yBN49LzXcWuoQwZMsYxeDL33KggLXpR+SpDhoxBjFpbvz8SqKWhQf0tQ4aMQQzSsyoWlmE3jH+a4LCFDBkyxjH4MKAG4IG4VgDLkCFjNoP/Qxo0yedIj3egQaYMGTLGMdIxQCfipUcr0pAtQ4aMqYy0xZaG5jQc14aaMmTI2IfRb72RpLB2LOyPNFGGDBkbMO5q8fOhI0860f0yZMgYyjjDxQ+K8SeQgCtDhoydGelQM90gHXmSp7XmtDJkyHgto3+QohM6yScrZrgyZMgYx+gUmTx9rMHQiEKGDBkycErHB5OdXQ5+QYYMGVsyOpVxOs4kgVuGDBn7MHg52m/ApTyUjMqQIWM0g5eOdwXf4LAXSD1lyJAxmvEB+qjRPyY+qgIAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
